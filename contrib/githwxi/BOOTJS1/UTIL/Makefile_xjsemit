########################################################################
########################################################################
# Makefile for bootstrapping
########################################################################
########################################################################
CAT=cat
ECHO=echo
NODE=node
########################################################################
BOOTJS1=./..
########################################################################
all:: xatsopt_tcheck00
########################################################################
SRCGEN1=./../../../../srcgen1
SRCGEN2=./../../../../srcgen2
XATSJSD=./../../../../srcgen2/xats2js
########################################################################
S1XSHRD=\
$(SRCGEN1)/xats2js/srcgenx/xshared/runtime
S2XSHRD=\
$(SRCGEN2)/xats2js/srcgenx/xshared/runtime
########################################################################
########################################################################
#
# HX-2025-03-29:
# $(S1XSHRD) is used since the library code for
# ATS3-Xanadu/source2 is largely shared with ATS3-Xanadu/source1
#
########################################################################
#
xatsopt_tcheck00: ; \
$(CAT) \
$(S2XSHRD)/xats2js_js1emit.js > $@_ats3.js && \
$(CAT) \
$(S1XSHRD)/srcgen1_prelude.js >> $@_ats3.js && \
$(CAT) \
$(S1XSHRD)/srcgen1_prelude_node.js >> $@_ats3.js && \
$(CAT) \
$(S1XSHRD)/srcgen1_xatslib_node.js >> $@_ats3.js && \
$(CAT) $(BOOTJS1)/lib/lib2xatsopt.js >> $@_ats3.js && \
$(NODE) --stack-size=4096 \
$(XATS2JS_JSEMIT00) $(SRCGEN2)/UTIL/xatsopt_tcheck00.dats >> $@_ats3.js
#
########################################################################
########################################################################
clean:: ; rm -f *~
cleanall:: ; rm -f *~
########################################################################
cleanall:: ; rm -f xatsopt_tcheck00_dats_ats3.js
########################################################################
########################################################################
XATSOPT_TCHECK00=$(SRCGEN2)/UTIL/xatsopt_tcheck00_dats.js
XATS2JS_JSEMIT00=$(XATSJSD)/srcgen1/UTIL/xats2js_jsemit00_ats2.js
########################################################################
########################################################################
