////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
//
// HX-2024-06-22:
// ATS3-XANADU/srcgen2/xats2js/srcgen1
//
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

'use strict';

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

let XATSINT1 = (i) => i
let XATSBOOL = (b) => b
let XATSCHAR = (c) => c
let XATSSFLT = (sflr) => sflt
let XATSDFLT = (dflt) => dflt
let XATSSTRN = (strn) => strn

////////////////////////////////////////////////////////////////////////////////////

let XATSVAR0 = () => [null]
let XATSVAR1 = (init) => [init]
let XATSFLAT = (addr) => addr[0]

////////////////////////////////////////////////////////////////////////////////////

let XATSDAPP = (dapp) => dapp
let XATSCAPP = (_, capp) => capp

////////////////////////////////////////////////////////////////////////////////////

let XATSPFLT = (pflt) => pflt
let XATSPROJ = (proj) => proj
let XATSP1RJ = (_, p1rj) => p1rj
let XATSP1CN = (_, p1cn) => p1cn

////////////////////////////////////////////////////////////////////////////////////
//
let XATSTRCD = (knd0) => knd0
//
let XATSTUP0 = (tpl0) => tpl0
let XATSTUP1 = (knd0, tpl1) => tpl1
let XATSRCD2 = (knd0, rcd2) => rcd2
//
////////////////////////////////////////////////////////////////////////////////////

let XATSROOT = (x) => [0, x]
let XATSLPFT = (i, x) => [1+0, x, i]
let XATSLPBX = (i, x) => [1+1, x, i]

let XATSVAR0 = () => XATSROOT([null])
let XATSVAR1 = (init) => XATSROOT([init])

let XATSADDR = (addr) => addr // HX: no-op
let XATSFLAT = (addr) => XATS000_lvget(addr)

////////////////////////////////////////////////////////////////////////////////////

let XATSCTAG = (_, t) => t
let XATS000_ctgeq = (v, t) => (v[0] == t)

////////////////////////////////////////////////////////////////////////////////////

let XATS000_casef = function()
  {
    throw new Error("XATS000_casef");
  }

let XATS000_patck = function(pck)
  {
    if (!pck) {
      throw new Error("XATS000_patck");
    } // end-of-[if]
  }

////////////////////////////////////////////////////////////////////////////////////


let XATS000_dl0az = (dlaz) => dlaz()
let XATS000_dl1az = (dlaz) => dlaz(1)

let XATS000_assgn =
  (lval, rval) => XATS000_lvset(lval, rval)

////////////////////////////////////////////////////////////////////////////////////

let XATS000_ftset =
  function(tpl0, idx1, rval)
  {
    let tpl1 = tpl0.slice();
    tpl1[idx1] = rval; return tpl1
  }

let XATS000_lvget = function(lval)
  {
    let ctag = lval[0]
    if (ctag === 0)
      return lval[1][0]
    if (ctag === 1+0)
      return XATS000_lvget(lval[1])[lval[2]]
    if (ctag === 1+1)
      return lval[1][lval[2]]
  }

let XATS000_lvset = function(lval, rval)
  {
    let ctag = lval[0]
    if (ctag === 0) return ( lval[1][0] = rval )
    if (ctag === 1+0)
    {
      return XATS000_lvset
	(lval[1], XATS000_ftset(XATS000_lvget(lval[1]), lval[2], rval))
    }
    if (ctag === 1+1) return ( lval[1][lval[2]] = rval )
  }

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
//
// end of [ATS3-XANADU/srcgen2/xats2js/srcgen1/xshared/runtime/xats2js_js1emit.js]
//
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
